#include "roBa.dtsi"

&default_transform {
    col-offset = <6>;
};

// Disable normal keyboard scanning for testing
&kscan0 {
    status = "disabled";
};

/ {
    // Test configuration for through-hole continuity check
    gpio_test {
        compatible = "zmk,behavior-macro";
        label = "GPIO_TEST";
        #binding-cells = <0>;
    };
    
    // Configure unused pins as test pins
    test_pins {
        compatible = "gpio-leds";
        
        // Use available GPIO pins for testing
        // These will output signals to test continuity
        test_pin_0: test_0 {
            gpios = <&xiao_d 0 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_0";
        };
        
        test_pin_1: test_1 {
            gpios = <&xiao_d 1 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_1";
        };
        
        test_pin_2: test_2 {
            gpios = <&xiao_d 2 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_2";
        };
        
        test_pin_3: test_3 {
            gpios = <&xiao_d 3 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_3";
        };
        
        test_pin_4: test_4 {
            gpios = <&xiao_d 4 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_4";
        };
        
        test_pin_5: test_5 {
            gpios = <&xiao_d 5 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_5";
        };
        
        test_pin_6: test_6 {
            gpios = <&xiao_d 6 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_6";
        };
        
        // Pin 7-10 are used by keyboard matrix normally
        // but we can repurpose them for testing
        test_pin_7: test_7 {
            gpios = <&xiao_d 7 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_7";
        };
        
        test_pin_8: test_8 {
            gpios = <&xiao_d 8 GPIO_ACTIVE_HIGH>;
            label = "TEST_PIN_8";
        };
    };
    
    // Input pins to read continuity
    test_inputs {
        compatible = "gpio-keys";
        
        input_0: input_0 {
            gpios = <&gpio0 2 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
            label = "INPUT_0";
        };
        
        input_1: input_1 {
            gpios = <&gpio0 3 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
            label = "INPUT_1";
        };
    };
};

// Disable SPI and trackball for testing
&xiao_serial { status = "disabled"; };
&spi0 { status = "disabled"; };